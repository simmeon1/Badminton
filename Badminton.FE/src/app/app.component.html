<mat-tab-group [selectedIndex]="selectedTab()" (selectedIndexChange)="selectedTab.set($event)">
    <mat-tab label="Form">
        <div class="container">
            <mat-accordion>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>Instructions</mat-panel-title>
                        <mat-panel-description></mat-panel-description>
                    </mat-expansion-panel-header>
                    <ul>
                        <li>Use the Add button to add new players from text input.</li>
                        <li>Check/uncheck players to enable/disable them.</li>
                        <li>Checking Shuffle names will produce a shuffled Players tab.</li>
                        <li>Click Submit to populate the Players and Matches tabs.</li>
                    </ul>
                </mat-expansion-panel>
            </mat-accordion>
            <mat-card>
                <mat-card-content>
                    <form novalidate (submit)="onSubmit($event)">
                        <div class="form-wrapper">
                            <div class="checkboxes-container">
                                @if (this.form.names().value().length > 0) {
                                    <mat-selection-list aria-label="Player list">
                                        @for (nameCheckbox of this.form.names().value(); track nameCheckbox; let i = $index) {
                                            <mat-list-option [togglePosition]="'before'" [selected]="nameCheckbox.checked" (click)="toggleCheckbox(i)">
                                                <div class="option-content">
                                                    <span class="option-label">{{ nameCheckbox.name }}</span>
                                                </div>
                                            </mat-list-option>
                                        }
                                    </mat-selection-list>
                                } @else {
                                    Use the Add button to add players.
                                }
                            </div>
                            <div>
                                <mat-form-field>
                                    <mat-label>Minimum games each?</mat-label>
                                    <input type="number" matInput [formField]="form.minGames">
                                </mat-form-field>
                            </div>
                            <div>
                                <mat-form-field>
                                    <mat-label>How many courts?</mat-label>
                                    <input type="number" matInput [formField]="form.courtCount">
                                </mat-form-field>
                            </div>
                            <div>
                                <mat-checkbox [formField]="form.shuffle">Shuffle names</mat-checkbox>
                            </div>
                            <div class="button-group">
                                <button matButton="filled" type="submit" class="submit" [disabled]="form().invalid() || !hasCheckedPlayers() || responseResource.isLoading()">Submit</button>
                                <button matButton type="button" (click)="openAddDialog()">Add players</button>
                                <button matButton type="button" (click)="clearAllPlayers()">Clear players</button>
                            </div>
                        </div>
                    </form>
                </mat-card-content>
            </mat-card>
        </div>
    </mat-tab>
    <mat-tab label="Players">
        <players [latestResponse]="responseResource.value()"
                       [isLoading]="responseResource.isLoading()"
                       [selectedPlayer]="selectedPlayer()"
                       (datasourceChanged)="datasourceChanged($event)"
                       (playersReordered)="playersReordered($event)"
                       (selectedPlayerChanged)="selectedPlayerChanged($event)"
        >

        </players>
    </mat-tab>
    <mat-tab label="Matches">
        <matches
                [latestResponse]="responseResource.value()"
                [isLoading]="responseResource.isLoading()"
                [selectedPlayer]="selectedPlayer()"
        ></matches>
    </mat-tab>
</mat-tab-group>
