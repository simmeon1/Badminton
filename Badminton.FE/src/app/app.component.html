<mat-tab-group [selectedIndex]="selectedTab()" (selectedIndexChange)="selectedTab.set($event)">
    <mat-tab label="Form">
        <mat-accordion>
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>Instructions</mat-panel-title>
                    <mat-panel-description></mat-panel-description>
                </mat-expansion-panel-header>
                <ul>
                    <li>Populate the Form and hit Submit to populate Players and Matches tab.</li>
                    <li>Switch to checkboxes to easily enable/disable players based on the text field.</li>
                    <li>Checking Shuffle names will produce a shuffled Players tab.</li>
                </ul>
            </mat-expansion-panel>
        </mat-accordion>
        <form novalidate (submit)="onSubmit($event)">
            <div class="form-wrapper">
                <mat-radio-group [formField]="form.submitText" (change)="radioChanged($event.value)">
                    <mat-radio-button [value]="true">Text</mat-radio-button>
                    <mat-radio-button [value]="false" [disabled]="form.namesText().invalid()">Checkboxes</mat-radio-button>
                </mat-radio-group>
                @if (form.submitText().value()) {
                    <div>
                        <mat-form-field>
                            <mat-label>Add players, one per line</mat-label>
                            <textarea matInput cdkTextareaAutosize [formField]="form.namesText"></textarea>
                        </mat-form-field>
                    </div>
                } @else {
                    @for (nameCheckbox of this.form.names().value(); track nameCheckbox; let i = $index) {
                        <div>
                            <mat-checkbox [formField]="this.form.names[i].checked">{{ nameCheckbox.name }}</mat-checkbox>
                        </div>
                    }
                }
                <div>
                    <mat-form-field>
                        <mat-label>Minimum games each?</mat-label>
                        <input type="number" matInput [formField]="form.minGames">
                    </mat-form-field>
                </div>
                <div>
                    <mat-form-field>
                        <mat-label>How many courts?</mat-label>
                        <input type="number" matInput [formField]="form.courtCount">
                    </mat-form-field>
                </div>
                <div>
                    <mat-checkbox [formField]="form.shuffle">Shuffle names</mat-checkbox>
                </div>
                <button matButton="filled" type="submit" [disabled]="form().invalid() || responseResource.isLoading()">Submit</button>
                <button matButton type="button" (click)="form.submitText().value.set(true); form.namesText().value.set('')">Clear names</button>
            </div>
        </form>
    </mat-tab>
    <mat-tab label="Players">
        <players [latestResponse]="responseResource.value()"
                       [isLoading]="responseResource.isLoading()"
                       [selectedPlayer]="selectedPlayer()"
                       (datasourceChanged)="datasourceChanged($event)"
                       (selectedPlayerChanged)="selectedPlayerChanged($event)"
        >

        </players>
    </mat-tab>
    <mat-tab label="Matches">
        <matches
                [latestResponse]="responseResource.value()"
                [isLoading]="responseResource.isLoading()"
                [selectedPlayer]="selectedPlayer()"
        ></matches>
    </mat-tab>
</mat-tab-group>
